Plan
  o start using just for internal microservices
  o then look at for apps

datanodes.io

Use cases:

o P: Your friends can see your User obj but not all fields
  S: /public-users and /private-users with different ACLs and different projections / xforms

o P: DOS attack by sending unindexed queries
  S1: Query permissions (coarse grained (like false))
  S2: "Data forms" but read version "Data Queries"
  S3: Endpoint rules on constrainable fields (might still not be enough (i.e. $ne DOS))
-----

o May need more fine grained permissions. Example, might want 'query' persmission to close collection endpoint (considering {} a query)
  Also the dual aof 'object' permission to see by ID. Combo powerful


DatanodeClient
  o MongoDBDatanodeClient
     - not full substitute for leafnode -- only when looking at
       mongodb as a datanode. if doing admin use leadnode
  o RESTDatanodeClient

But how do you interact with endpoints that are not collections? Maybe
you dont

Maybe DNs should be less open-ended. Only allowing for collections and
commands?

On server
Collections take one are (query) and endpoint pattern is
<root>[/?id][?<query>]
  doGetObject(id)
  doGetObjects(query, options)
  doInsert(o)
  doUpdateObjects(query, update)
  doUpdateObject(id, update)
  doSave(o)
  doDeleteObjects(query)
  doDeleteObject(id) 
  beforeX
  afterX or use super?

Command (POST) (should allow at any endpoint?)
  doCommand(cmd)

Dataforms and Data Views?

On client (allows callback and sync style)
   .<http-method>(path)? // lower lower leval? (or could be .getRESTClient())
   .getEndpoints() // this is lower level interface?
   .getCollection(n)
      .findById(id)
      .find(q, options)
      .findOne()
      .insert()
      .update(id, update)
      .save(o)
      .deleteById(id)
      .delete(query)
      .findAndModify()???? (later)
      
   .command(cmd)

.connect(uri)


var panama = datanode.connect("http://panama.mongolab.com")
panama.getCollection("events").insert(e)
panama.getCommand("shutdown").exec()
panama.command("shutdown", {})
panama.command("restart", {"wait": 1000})

cmdline (should it just work with o when given http url?)
% o http://localhost:8800/

-- Every serverside call (like form calls (but what about collections/cmds?)) get user id from client
   being authenticated. DatanodeClients used from browser need to
   authenticate for end user

-- Datanode support for Kerberos? That would be cool
------------------
------------------
Features
o main service
o declaritive argparse
o schema / ODM (these are different. one is schema one is object,
  binding (they should be consistent with each othr)
o autogenerated docs, with interactive examples, playground to try
  -- maybe each ObjectServer has an endpoint (default to /) that
  -- serves up this UI
  -- kind of like a data browser?
o automated testing of api
o automatic mocking of api
o automatic admin UI
o logging 
o auditing (different?)
o monitoring (both alive-ness and performance and correctness (from
   --testdefs)
o auto /status endpoint plus pacemaker that calls status()
o pluggable auth model (apikey, http basic, etc...)
o acl / security 
o autogen forms?
o proxy / load balancing
o datanode-client
o datanode shell (like mongo shell) (also restshell)?
o api versioning
o cursors for dbs
o RSS
o REST Envelope and non-envelope formats

Create a lot of examples

Doc up a list of Endpoint types with methods
  Endpoint
    Collection
    DataView
    DataForm
     
